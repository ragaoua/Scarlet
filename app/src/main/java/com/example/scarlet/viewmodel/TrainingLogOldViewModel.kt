package com.example.scarlet.viewmodel

import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import com.example.scarlet.db.ScarletRepository
import com.example.scarlet.db.model.Block
import com.example.scarlet.db.model.Session
import dagger.hilt.android.lifecycle.HiltViewModel
import kotlinx.coroutines.launch
import javax.inject.Inject

@HiltViewModel
class TrainingLogOldViewModel @Inject constructor(
    private val repository: ScarletRepository
) : ViewModel() {

    ///////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////// BLOCK ////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    fun endBlock(block: Block) {
        viewModelScope.launch {
            block.completed = true
            repository.updateBlock(block)
        }
    }

    ///////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////// SESSION ///////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    fun getSessionsByBlockId(blockId: Int) = repository.getSessionsByBlockId(blockId)

    fun addSession(block: Block) {
        viewModelScope.launch {
            repository.insertSession(Session(blockId = block.id))
        }
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////// EXERCISE ///////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////
    fun getExercisesBySessionId(sessionId: Int) = repository.getExercisesBySessionId(sessionId)

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////// SET /////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    fun getExerciseSetsById(exerciseId: Int) = repository.getExerciseSetsById(exerciseId)

}